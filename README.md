# Описание
Служба для автоматической очистки логов исполнительной среды MasterSCADA 4D ***(на Linux)*** **при проблеме отсутствия подключения к АРМ** среды исполнения MS4D из-за быстрого переполнения носителя с небольшим объёмом памяти.
> *Для запуска необходим **Python 3.7+***
> <br>
> *Также должна быть установлена утилита* `lsof`


# Установка
1. Загрузите репозиторий в директорию `/opt`:
    ```sh
    sudo git clone 'https://github.com/ss3nclam/mplc4-cleaner.git' /opt
    ```

2. *(необязательно)* Настройте параметры в `config.conf` на своё усмотрение:
    - ***defaults***
        - **max_disk_usage** - максимальный объём занятого пространства на диске ***(%)***, при превышении которого будет произведено удаление логов `mplc4` **(по-умолчанию - *85*)**
        - **max_logs_count** - максимальное количество файлов в директории, при превышении которого будет произведено удаление логов `mplc4` **(по-умолчанию - *10*)**
        - **inspection_frequency** - периодичность проверки ***(сек.)*** **(по-умолчанию - *1800*)**
    - ***logging***
        - **logging** - логирование ***(bool)*** **(по-умолчанию - *true*)**
        - **to_file** - записывать логи в файл ***(bool)*** **(по-умолчанию - *true*)**
        - **level** - уровень логирования ***('info', 'warning', 'error', 'debug')*** **(по-умолчанию - *debug*)**

3. Проверьте содержимое `/etc/sudoers` и убедитесь в том, что строка `root ALL=(ALL) ALL` не закомментирована:
    ```sh
    sudo cat /etc/sudoers | grep --color 'root ALL=(ALL) ALL'
    ```
    В обратном случае её **необходимо раскомментировать**

3. Запустите `install.sh` из загруженного репозитория:
    ```sh
    sudo bash /opt/mplc4-cleaner/install.sh
    ```

4. Убедитесь в успешной установке и работе службы:
    ```sh
    sudo systemctl status mplc4-cleaner
    ```

5. Убедитесь, что служба `mplc4` запущена и работает исправно:
    ```sh
    sudo systemctl status mplc4
    ```
    *Так же:*
    ```sh
    ps -e | grep mplc
    ```
